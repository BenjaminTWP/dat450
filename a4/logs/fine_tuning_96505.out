/data/courses/2025_dat450_dit247/venvs/dat450_venv/bin/python3
Job started at: Sat Nov 29 07:25:23 PM CET 2025
Running on node: neptune
Job ID: 96505
GPU: 2
================================================================================
CONFIGURATION
================================================================================
output_dir: ./outputs
dataset_dir: /data/courses/2025_dat450_dit247/datasets/alpaca-cleaned
model_path: /data/courses/2025_dat450_dit247/models/OLMo-2-0425-1B
num_epochs: 2
seed: 101
max_train_samples: 2000
max_test_samples: 200
max_length: 512
max_new_tokens: 128
device: cuda
================================================================================

================================================================================
LOADING ALPACA DATASET
================================================================================

ALPACA DATASET:
DatasetDict({
    train: Dataset({
        features: ['instruction', 'input', 'output'],
        num_rows: 51760
    })
})

ALPACA + SUBSAMPLE:
DatasetDict({
    train: Dataset({
        features: ['instruction', 'input', 'output', 'strat_label'],
        num_rows: 2000
    })
    test: Dataset({
        features: ['instruction', 'input', 'output', 'strat_label'],
        num_rows: 200
    })
})

================================================================================
BUILDING PROMPTS
================================================================================

Sample with prompt:
{
  "instruction": "Generate 5 questions relevant to the following topic",
  "input": "Men's fashion",
  "output": "1. What are some current trends in men's fashion?\n2. What are some classic, timeless pieces that every man should have in his wardrobe?\n3. How can men accessorize their outfits to add some individuality to their style?\n4. What are some tips for dressing well on a budget, while still maintaining a fashionable appearance for men?\n5. Are there any new and emerging designers in the men's fashion scene that are worth keeping an eye on?",
  "strat_label": 1,
  "prompt": "Below is an instruction that describes a task, paired with an input that provides further context. \nWrite a response that appropriately completes the request.\n\n### Instruction:\nGenerate 5 questions relevant to the following topic\n\n### Input:\nMen's fashion\n\n### Response:",
  "answer": "1. What are some current trends in men's fashion?\n2. What are some classic, timeless pieces that every man should have in his wardrobe?\n3. How can men accessorize their outfits to add some individuality to their style?\n4. What are some tips for dressing well on a budget, while still maintaining a fashionable appearance for men?\n5. Are there any new and emerging designers in the men's fashion scene that are worth keeping an eye on?"
}

================================================================================
TOKENIZATION
================================================================================

TOKENIZED DATASET:
DatasetDict({
    train: Dataset({
        features: ['instruction', 'input', 'output', 'strat_label', 'prompt', 'answer', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 2000
    })
    test: Dataset({
        features: ['instruction', 'input', 'output', 'strat_label', 'prompt', 'answer', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 200
    })
})

================================================================================
EVALUATING PRETRAINED MODEL
================================================================================

PRETRAINED EVAL METRICS:
{
  "eval_loss": 1.4571175575256348,
  "eval_model_preparation_time": 0.0028,
  "eval_rougeL": 0.6181726620325895,
  "eval_runtime": 22.9625,
  "eval_samples_per_second": 8.71,
  "eval_steps_per_second": 4.355
}

================================================================================
TRAINING BASELINE MODEL (FULL SFT)
================================================================================
Full SFT trainable params: 1484916736
{'loss': 1.7714, 'grad_norm': 9.353922843933105, 'learning_rate': 2.50125e-05, 'epoch': 1.0}
{'eval_loss': 1.6613649129867554, 'eval_rougeL': 0.5477741102862703, 'eval_runtime': 16.6959, 'eval_samples_per_second': 11.979, 'eval_steps_per_second': 11.979, 'epoch': 1.0}
{'loss': 0.536, 'grad_norm': 3.4086623191833496, 'learning_rate': 1.2500000000000001e-08, 'epoch': 2.0}
{'eval_loss': 1.8427563905715942, 'eval_rougeL': 0.5586101857236212, 'eval_runtime': 19.1704, 'eval_samples_per_second': 10.433, 'eval_steps_per_second': 10.433, 'epoch': 2.0}
{'train_runtime': 1007.9962, 'train_samples_per_second': 3.968, 'train_steps_per_second': 3.968, 'train_loss': 1.1537082824707032, 'epoch': 2.0}

BASELINE EVAL METRICS:
{
  "eval_loss": 1.8427563905715942,
  "eval_rougeL": 0.5586101857236212,
  "eval_runtime": 16.8507,
  "eval_samples_per_second": 11.869,
  "eval_steps_per_second": 11.869,
  "epoch": 2.0
}

================================================================================
TRAINING LORA MODEL
================================================================================
